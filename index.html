<!doctype html>
<!--[if lt IE 7]>      <html class="lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html> <!--<![endif]-->
<head>
  <script src="js/phaser.min.js"></script>
</head>
<body style="background-color:#333;" style="margin:0px;">
  <script src="js/ScaleManager2.js"></script>
  <script src="js/game.js"></script>
  <script type="text/javascript">
	Game = function (game) {

			//	When a State is added to Phaser it automatically has the following properties set on it, even if they already exist:

		    this.game;		//	a reference to the currently running game
		    this.add;		//	used to add sprites, text, groups, etc
		    this.camera;	//	a reference to the game camera
		    this.cache;		//	the game cache
		    this.input;		//	the global input manager (you can access this.input.keyboard, this.input.mouse, as well from it)
		    this.load;		//	for preloading assets
		    this.math;		//	lots of useful common math operations
		    this.sound;		//	the sound manager - add a sound, play one, set-up markers, etc
		    this.stage;		//	the game stage
		    this.time;		//	the clock
		    this.tweens;	//	the tween manager
		    this.world;		//	the game world
		    this.particles;	//	the particle manager
		    this.physics;	//	the physics manager
		    this.rnd;		//	the repeatable random number generator
		    
		    //	You can use any of these from any function within this State.
		    //	But do consider them as being 'reserved words', i.e. don't create a property for your own game called "world" or you'll over-write the world reference.

		};

		Game.prototype = {

			create: function () {
			},

			update: function () {
			},

			quitGame: function (pointer) {
			}, 
			pausedUpdate: function () {

			}
		};
	 (function () {
	 	/* Variables for account information/login screen
	 	** due to the nature of CocoonJS functions being internalized, these flags are managed globally 
	 	** through Game in order to avoid the altering the code of CocoonJS functions/event handlers */
	 	// Flag for loading UI elements based on logged in/not logged in
	 	Game.loggedIn = false;
	 	// Flag used in account screen to prevent multiple calls to CocconJS dialog box
	 	Game.loginAttempt = false;
	 	// Flag used when user presses cancel button on either username or password field
	 	Game.loginCancelled = false;
	 	// Flag used to delay further code until ajax.js has finished loading xml and parsing data
	 	Game.loginComplete = false;
	 	// Flags for opening CocoonJS dialog boxes in proper order. Username -> Passowrd
	 	Game.userNameEntered = false;
	 	Game.passWordEntered = false;
	 	Game.userName = "!";
	 	Game.passWord = "!";

	 	Game.landscape = false;
	 	Game.skewX = 1;
	 	Game.skewY = 1;
	 	// Global game values, primarily used for scaling by loading assets based on screen size
		Game.screen = "large";
		Game.fontSize = "30px Arial Bold";
		Game.speed;
		Game.srx = Math.max(window.innerWidth, window.innerHeight);
		Game.sry = Math.min(window.innerWidth, window.innerHeight);
		
		Game.logicWidth = 480;
		var r = 1.6;
		
		// If on deskop, we may need to fix the maximum resolution instead of scaling the game to the full monitor resolution
		var device = new Phaser.Device();
		if(device.desktop){
			Game.screen = "xxlarge";
			Game.fontSize = "60px Arial Bold";
			Game.gameWidth = 1440;	
		}
		else {
			Game.srx *= window.devicePixelRatio;
			Game.sry *= window.devicePixelRatio;
			if ((Game.srx/Game.sry) > r){
				console.log(r);
				r = Game.srx/Game.sry;
			}
			if(Game.srx >= 960){
				Game.screen = "xlarge";
				Game.fontSize = "40px Arial Bold";
				Game.gameWidth = 960;
			}
			if(Game.srx >= 1440){
				Game.screen = "xxlarge";
				Game.fontSize = "60px Arial Bold";
				Game.gameWidth = 1440;
			}
		}
		device = null;
		
		Game.logicHeight = Game.logicWidth/r;
		Game.gameHeight = Game.gameWidth/r;
		// We need these methods later to convert the logical game position to display position, 
		// So convertWidth(logicWidth) will be right edge for all screens
		Game.convertWidth = function(value){
			return value / Game.logicWidth * Game.gameWidth;
		};
		Game.convertHeight = function(value){
			return value / Game.logicHeight * Game.gameHeight;
		};
		// This method exists to rescale the games internal size values if needed
		Game.rescale = function() {
			Game.srx = window.innerWidth * window.devicePixelRatio;
			Game.sry = window.innerHeight * window.devicePixelRatio;
			r = 1.6;
			
			if ((Game.srx/Game.sry) > r){
				r = Game.srx/Game.sry;
			}
		
			Game.logicHeight = Game.logicWidth/r;
			Game.gameHeight = Game.gameWidth/r;
		};
	})();
	</script>
 	<div id="canvas1"></div>
</body>
</html>